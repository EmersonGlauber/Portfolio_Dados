---
title: "Vacinação"
output:
  html_document: default
date: "2026-01-07"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Dado de janeiro de 2026 (dados incompletos)

### Contexto
O ano de 2026 começou e o Ministério da Saúde disponibilizou os dados de vacinação até 05 de janeiro de 2026.  
O objetivo deste projeto é descrever o perfil dos dados de vacinas que estão sendo aplicadas no serviço privado, portanto:  
 - Qual a faixa etária dos vacinados até o dia 05/01/2025?  
 - Quais as vacinas aplicadas nos primeiros 5 dias de 2026?  
 - Quais estados estão aplicando mais vacina?  
 - Qual sexo está vacinando mais?

### Tratamento dos dados - ETL
Importar pacotes

``` {r, warning = F, message = F}
library(dplyr)
library(kableExtra)
library(ggplot2)
```

Importar dados
```{r}
dados <- read.csv2("dados/vacinacao_jan_2026.csv")
```

Tratar tabela para:  
- Colunas importantes para análise  
- Filtrar somente serviços privados  
- Renomear colunas  
- Recodificar nome dos Estados

```{r}
# filtrar por colunas
dados_filtrados <- dados %>% select(tp_sexo_paciente, nu_idade_paciente, 
sg_uf_estabelecimento, co_vacina, sg_vacina, co_estrategia_vacinacao)

#filtrar por serviços privados
dados_filtrados <- dados_filtrados %>% filter(co_estrategia_vacinacao == 8)

#renomear colunas
dados_filtrados <- dados_filtrados %>% rename(sexo_paciente = tp_sexo_paciente) %>% 
  rename(idade = nu_idade_paciente) %>% rename(estado = sg_uf_estabelecimento) %>% 
  rename(vacina = sg_vacina)

#vetor para nome dos estados
nomes_estados <- c("AC" = "Acre", "AP" = "Amapá", "AM" = "Amazonas", "PA" = "Pará",
             "RO" = "Rondônia", "RR" = "Roraima", "TO" = "Tocantins", 
             "AL" = "Alagoas", "CE" = "Ceará", "SE" = "Sergipe", "BA" = "Bahia",
             "PE" = "Pernambuco", "RN" = "Rio Grande do Norte", "PB" = "Paraíba",
             "MA" = "Maranhão", "PI" = "Piauí",
             "MT" = "Mato Grosso", "MS" = "Mato Grosso do Sul", "GO" = "Goiás",
             "DF" = "Distrito Federal",
             "SP" = "São Paulo", "RJ" = "Rio de Janeiro", "ES" = "Espírito Santo",
             "MG" = "Minas Gerais",
             "PR" = "Paraná", "SC" = "Santa Catarina", "RS" = "Rio Grande do Sul")

#alterar codigo dos estados
dados_filtrados$estado <- nomes_estados[dados_filtrados$estado]

#trocar siglas de masculino e feminino
sexo <- c("M" = "Masculino", "F" = "Feminino")
dados_filtrados$sexo_paciente <- sexo[dados_filtrados$sexo_paciente]

#criar coluna de faixa estária
dados_filtrados <- dados_filtrados %>%
  mutate(faixa_etaria = case_when(
    idade %in% 0:1   ~ "até 1 ano",
    idade %in% 2:9   ~ "2 a 9 anos",
    idade %in% 10:19 ~ "10 a 19 anos",
    idade %in% 20:29 ~ "20 a 29 anos",
    idade %in% 30:39 ~ "30 a 39 anos",
    idade %in% 40:49 ~ "40 a 49 anos",
    idade %in% 50:59 ~ "50 a 59 anos",
    idade %in% 60:79 ~ "60 a 79 anos",
    idade %in% 80:99 ~ "80 a 99 anos",
    TRUE ~ NA_character_
  ))

#os dados vieram sem o nome das vacinas 115 e 116
dados_filtrados <- dados_filtrados %>% 
  mutate(vacina = case_when(
    vacina == "" & co_vacina == 115 ~ "Nirsevimabe 0,5ml",
    vacina == "" & co_vacina == 116 ~ "Nirsevimabe 1,0ml",
    TRUE ~ vacina
  ))
```

### Estatistica Descritiva

```{r}
#vacinas por estado
vac_estado <- dados_filtrados %>% group_by(estado) %>% count()
vac_estado <- vac_estado %>% mutate(porcentagem = (n / sum(vac_estado$n))*100)
vac_estado <- vac_estado %>% mutate(porcentagem = round(porcentagem, digits = 2)) %>% 
  arrange(desc(n))
vac_estado %>% kable() %>% kable_styling(
 bootstrap_options = "basic",
 position = "center",
 font_size = 14
)

# gráfico de vacinas por estado
ggplot(vac_estado, aes(n, estado)) + geom_col()

```


```{r}
#vacinas por sexo
vac_sexo <- dados_filtrados %>% group_by(sexo_paciente) %>% count()
vac_sexo <- vac_sexo %>% mutate(porcentagem = (n / sum(vac_sexo$n))*100)
vac_sexo <- vac_sexo %>% mutate(porcentagem = round(porcentagem, digits = 2))
vac_sexo %>% kable() %>% kable_styling(
  bootstrap_options = "basic",
  position = "center",
  font_size = 14
)

# gráfico de vacinas por sexo
ggplot(vac_sexo, aes(sexo_paciente, n)) + geom_col(fill = "#FF3333")

```



```{r}
#vacinas por faixa etária
vac_faixa <- dados_filtrados %>% group_by(faixa_etaria) %>% count()
vac_faixa <- vac_faixa %>% mutate(porcentagem = (n / sum(vac_faixa$n))*100)
vac_faixa <- vac_faixa %>% mutate(porcentagem = round(porcentagem, digits = 2))
vac_faixa %>% kable() %>% kable_styling(
  bootstrap_options = "basic",
  position = "center",
  font_size = 14
)

media <- round(mean(dados_filtrados$idade), digits = 2)
desvp <- round(sd(dados_filtrados$idade), digits = 2)
mediana <- median(dados_filtrados$idade)

print(paste("A média da idade é ", media, "com desvio padrão de ", desvp))
print(paste("A mediana da idade é", mediana))

# gráfico de vacinas por faixa etária
ggplot(vac_faixa, aes(faixa_etaria, n)) + geom_col(fill = "#0066CC")

```


```{r}
#por tipo de vacina
vac_tipo <- dados_filtrados %>% group_by(vacina) %>% count()
vac_tipo <- vac_tipo %>% mutate(porcentagem = (n / sum(vac_tipo$n))*100) %>% 
  mutate(porcentagem = round(porcentagem, digits = 2)) %>% arrange(desc(n))
vac_tipo %>% kable() %>% kable_styling(
  bootstrap_options = "basic",
  position = "center",
  font_size = 14
)

# gráfico de vacinas por tipo
ggplot(vac_tipo, aes(n, vacina)) + geom_col()
```

## Fonte dos dados
Ministério da Saúde. Dados Abertos. Acessado em 07 jan 2026. Disponível em [link](https://dadosabertos.saude.gov.br/dataset/doses-aplicadas-pelo-programa-de-nacional-de-imunizacoes-pni-2026)